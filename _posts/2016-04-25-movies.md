---

layout: post
title: gender equality in the cinema
excerpt: "an assessment of gender equality across different cinematic eras"
categories: [Metis Projects]
comments: true
image:
  feature: https://cdn.theatlantic.com/assets/media/img/mt/2014/03/heathers1/lead_large.jpg
  credit: 
  creditlink:
---

Inspired by Matt Daniels and Hannah Anderson's [polygraph.cool](http://polygraph.cool/movies) Film Dialogue breakdown, I 
decided to venture into the world of gender distribution in movies. I used, in part, the painstakingly collected polygraphcool data, which includes the number of lines spoken by male characters in a collection of 2000 movies.

Matt Daniels and Hannah Anderson had already worked hella hard and split the movie scripts by character and by comparing to IMDB, assigned a sex and age to each character's actor/actress. The resulting metadata as well as some of the data is publicly available on Matt Daniels' github page for scrutiny and further data fun. 

I wanted to use all this lovely data to see whether it was possible to predict the year a movie came out in based on it's character and line ratio. 

I wanted to include genre in my analysis because there is a big difference in the standard distribution of female and male characters in movies of different genres. For example, war movies tend to contain way more male characters and romantic movies are generally more balanced. Because the proportion of movies of each genre that come out every year isn't standard, it is better to analyse temporal changes in gender on the screen per genre. For this I needed to scrape.

#### Web scraping with Beautiful Soup

I collected data on genre by scraping Box Office Mojo using [Beautiful Soup](https://www.crummy.com/software/BeautifulSoup/)
(I will have another post outlining the scraping process). I scraped data on all the movies they have on the site including info on budget and domestic gross in case I decided to use that later on. The data I needed was in a table. I looped through the `tr`s and filled in a pandas dataframe as I went, then saved as a csv. 

#### Data wrangling
I read both my csv files in as pandas dataframes so I could clean and preprocess anything I needed to using pandas.

```python
import pandas as pd

mojo_df = pd.read_csv('<path_to_mojo_csv>', encoding="ISO-8859-1")
polygraph_df = pd.read_csv('<path_to_polygraph_csv>', encoding="ISO-8859-1")
```
I wanted to create parameters that represented the number of female to male characters and lines, so I calculated ratios.

```python
import numpy as np 

f_ratio = []

for lines in df_new['lines_data']:
    male = sum(int(i) for i in lines.strip())/len(lines)
    female = 7.01 - male
    f_ratio.append(female/male)

merged_df['ratio']= pd.DataFrame(f_ratio)

```

The dataset from polygraph cool contains a data on the number of lines spoken by male characters in the film. It looks kind of like this: `77777774344464457343324234364433534457742623247464315641475525432227444643573547563634643367654666775777777777744444555375334224252554425254477526314275553245514656245322356255535653566626437343576645667766774` Nice, huh?
It assumes that a minute of dialogue is approximately 14 lines (using average speaking pace of 140 words/min, and average 10 words/line). Each number in the string there represents the number of lines spoken by a male every half minute. So, what I calculate there as `f ratio`, is the _maximum_ number of lines a woman could possibly speak in a film, if she spoke for all the time left where a man isn't talking. A generous estimate, comprendez? By the way, those lines correspond to _Avatar_, 2009, for which the ratio is `0.52`.

Ok, moving on. I had to create dummy variables of the genres. This means generating a column for each genre and assigning a 1 if the movie is of that genre and a 0 if it's not. But I had 67 genres so this enlarged my feature space by quite a bit and I didn't want to make life too difficult for myself.

To reduce the feature space, I condensed some of the more obscure genres into broader ones. Obscure meaning 'Comedy' was originally split into 'Comedy', 'Comedy/Drama', 'Comedy/Thriller', 'Comedy/Crime', etc. It was a little tricky sometimes, for example, does 'War Romance' go into 'War' or 'Romance'? In the end I manually condensed the genres, reducing the 67 genres to 10.

```python
genre_collapser = {
	'Action':'Action',
   'Action / Adventure':'Action',
   'Action / Crime':'Action',
   'Action Comedy':'Action',
   'Action Drama':'Action'
   }

for i in range(len(mojo_df['genre'])):
    mojo_df.ix[i,'genre'] = genre_collapser[mojo_df.ix[i,'genre']]
```

Now I could create my dummy variables without feature space concerns:

```python
df_dummied = pd.get_dummies(df_reduced_merged['genre'], prefix='genre')
df_dummied = df_dummies.drop('genre_None', axis=1)
```
The `prefix` parameter there prefixes each genre name with the word 'genre', to keep our column names clear. On

Now I had all this cleaned data from Box Office Mojo and I only needed the genres for the movies from the polygraph movies.

```python
polygraph_df["movie"] = polygraph_df["year"].map(str) + " " + polygraph_df["title"]
mojo_df["movie"] = mojo_df["year"].map(str) + " " + mojo_df["title"]

merged_df = pd.merge(mojo_df, polygraph_df, on=['movie'])
```

I created a column containing the year of release and movie title, and merged the two dataframes on that column. This was to avoid mixing up movies with the same title that came out in different years. This approach worked well except for one little movie, _Crash_, which according to IMDB came out in 2004 but in the dataset it came out in 2005. Whoops. Other than that the movies seem to be solidly matched. I now had 1198 movies left in my dataset.



#### Model building

OK time for some models. I split my data into a training set and a test set and using the statsmodels package modelled the data using Ordinary Least Squares.

```python
import statsmodels.api as sm

model = sm.OLS(Y, X)
results = model.fit()
results.summary()
```














